---
- name: Setting ANSIBLE_INVENTORY environmental configuration
  shell: echo "export ANSIBLE_INVENTORY=/home/ubuntu/GoldenWaste/ansible/hosts/GoldenWasteHosts" >> ~/.profile

- name: Setting ANSIBLE_HOST_KEY_CHECKING environmental configuration
  shell: echo "export ANSIBLE_HOST_KEY_CHECKING=False" >> ~/.profile

- name: Create .aws directory if it does not exist
  file:
    path: /home/ubuntu/.aws
    state: directory
    mode: '0755'

- name: Copy AWS config file to .aws directory
  template:
    src: config.j2
    dest: /home/ubuntu/.aws/config
    owner: root
    group: root
    mode: '0600'

- name: Copy AWS credentials file to .aws directory
  template:
    src: credentials.j2
    dest: /home/ubuntu/.aws/credentials
    owner: root
    group: root
    mode: '0600'

- name: Setting WEB_PRIVATE_IP as an environment variables
  shell: echo "export WEB_PRIVATE_IP=$(aws ec2 describe-instances --filters Name=tag:Name,Values=GoldenWasteWebApp --query 'Reservations[*].Instances[*].PrivateIpAddress')" >> ~/.profile

- name: Setting DB_PRIVATE_IP as an environment variables
  shell: echo "export DB_PRIVATE_IP=$(aws ec2 describe-instances --filters Name=tag:Name,Values=GoldenWasteDB --query 'Reservations[*].Instances[*].PrivateIpAddress')" >> ~/.profile

- name: Setting WEB_PUBLIC_IP as an environment variables
  shell: echo "export WEB_PUBLIC_IP=$(aws ec2 describe-instances --filters Name=tag:Name,Values=GoldenWasteWebApp --query 'Reservations[*].Instances[*].PublicIpAddress')" >> ~/.profile